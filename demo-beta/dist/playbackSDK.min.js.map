{"version":3,"sources":["webpack:///webpack/bootstrap 892d98136ff05747d37d","webpack:///./js/playbackSDK.js"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","configurable","enumerable","get","n","__esModule","object","property","prototype","hasOwnProperty","p","s","$","window","document","Socket","opts","isHttps","location","protocol","host","chat","indexOf","split","length","port","parseInt","isNaN","httpsPort","terminal","MobileLive","isMobile","io","connect","query","roomid","roomId","sessionid","viewer","sessionId","platform","substepRequest","ajax","url","type","data","tryCount","retryLimit","timeout","dataType","success","done","error","xhr","textStatus","errorThrown","this","fn","status","substepRequestHistoryData","param","userid","userId","liveid","liveId","upid","upId","recordid","recordId","viewertoken","viewername","forcibly","sub","globalData","requestLoginData","requestInfoData","requestDrawData","requestChatqaData","allRequests","on_cc_login_error","checkout","options","drawRequestTime","datas","TIMEOUT","DWDpc","fastMode","util","log","callback","state","StateMachine","snapshoot","drawsInfoRequestPool","DrawsInfoRequestPool","concatMeta","on_cc_request_draw_error","on_cc_request_chatqa_error","on_cc_request_info_error","d1","d2","extend","meta","requestState","result","startTime","endTime","key","index","states","drawsAlready","setSnapshoot","docId","getSnapshoot","init","blockTime","setState","httpRequest","self","abort","getState","getStates","getCurrentStateIndex","currentTime","isDrawsAlready","distinct","a","b","arr","concat","obj","JSON","stringify","push","requestNumber","httpRequestPool","draws","preState","isHttpRequestCurrentDraws","_state","httpRequestCurrentDraws","starttime","endtime","draw","sort","p1","p2","time","httpRequestStream","j","isRequestDraws","k","splice","httpRequestSnapshoot","e","_snapshoot","_isSnapshoot","pageNum","docid","currentpage","ListenerDuration","on_cc_limit_request_draws","t","setInterval","callbackPlayer","getDuration","clearInterval","duration","Math","ceil","blockDuration","setTimeout","isHistoryReady","drawPanel","isReady","initDrawPanelInfo","on_cc_request_snapshoot","pageChange","getPlayerTime","Callback","chatLogs","broadcasts","pageChanges","questions","answers","animations","pageChangeIndex","drawIndex","animationIndex","swfobject","embedSWF","id","width","height","allowFullscreen","allowScriptAccess","wmode","getFlash","getObjectById","clear","swf","js","jstr","drawList","filp","jj","parse","u","replace","adapt","animation","animationChange","intervalNum","interval","ft","isCustomSeek","nextTime","abs","beforeTime","seekComplete","pidex","pc","encryptDocId","fileName","docName","totalPage","docTotalPage","page","step","on_cc_callback_page_change","useSDK","on_cc_callback_pagechange","dc","intervalPainting","history","val","room","documentDisplayMode","appendDrawPanel","pusherNode","primary","encryptLiveId","viewerId","socket","on_cc_callback_player","live","encryptRecordvideoId","DW","isH5play","pages","imgUrl","on_cc_callback_pages","broadcast","on_cc_live_broadcast_msg","content","question","on_cc_live_qa_question","action","value","encryptId","questionUserId","userName","questionUserName","userAvatar","questionUserAvatar","isPublish","answer","on_cc_live_qa_answer","questionId","answerUserId","isPrivate","answerUserName","answerUserAvatar","userRole","answerUserRole","chatLog","on_cc_live_chat_msg","username","msg","useravatar","usercustommark","userCustomMark","CHATLOGS","cc_live_callback_chat_interval","BROADCASTS","cc_live_callback_broadcasts_interval","on_cc_h5_player_load","onCCH5PlayerLoad","playbackPanel","getElementById","config","playerId","chatMessageCache","cache","lastTimeRefresh","Date","getTime","INTERVAL_TIME","refresh","ableRefresh","min","shift","on_cc_live_chat_msg_sync","broadcastCache","on_cc_live_broadcast_msg_sync","debug","arg1","arg2","console","videoId","isShowBar","role","dpc","Dpc","dp","parent","append","remove","on_cc_live_db_flip","ac","h","setFastMode","createElement","canPlayType","vidTest","oggTest","h264Test","checkVideo","scriptArray","loadScript","viewerid","DrawingBoard","logout","xhrFields","withCredentials","getScript","readyState","script","src","onload","onreadystatechange","body","appendChild","res","_res","_this","queue","fs","cb","playbackRate","seek","docAdapt","getBuffer","setVolume","getVolume","play","setZScale","getZScale","setScale","getScale","openSettingPanel","isLivePlayerReady","cl","bc","isPublishing","flashvars","videoid","ua","params","flashPlayerInit","ReportLog","parseFloat","getH5player","getPosition","buffered","end","getBufferLength","volume","isPlay","pauseState","pause","on_cc_live_player_init","start","on_cc_live_player_load","seekStart","ds","slice","dcdatas","Event","addEvents","target","eventType","handle","addEventListener","attachEvent","arguments","pvdefault","video","playurl","secureplayurl","appendVideo","v","playbackPlayer","html","removeAttribute","isMobie","isAndroid","on_player_start","on_spark_player_resume","on_spark_player_pause","on_spark_player_end","floor","appendDoc","img","isIPad","isIPhone","isWindowsPhone","navigator","userAgent","match","jQuery"],"mappings":"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","file":"playbackSDK.min.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 0);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 892d98136ff05747d37d","/**\n * CC playback video\n * v2.5.0 2018/11/19\n */\n!(function ($, window, document) {\n\n    // 直播播放器信息\n    var CallbackPlayer = function (opts) {\n        this.isReady = false;\n        this.isPublishing = 0;\n        this.id = opts.callbackPlayer.id;\n\n        var swfUrl = '//player.csslcloud.net/platform/live/CallbackPlayer.swf';\n        var flashvars = {\n            'userid': opts.userId,\n            'videoid': opts.videoId,\n            'recordid': opts.recordId,\n            'isShowBar': opts.isShowBar,\n            'upid': opts.upId,\n            'viewerid': opts.viewerId,\n            'roomid': opts.roomId,\n            'ua': '1'\n        };\n        var params = {\n            allowFullscreen: 'true',\n            allowScriptAccess: 'always',\n            wmode: 'transparent'\n        };\n\n        this.flashPlayerInit = function () {\n            swfobject.embedSWF(swfUrl, opts.callbackPlayer.id, opts.callbackPlayer.width, opts.callbackPlayer.height, '10.0.0',\n                '/flash/expressInstall.swf', flashvars, params);\n            if (MobileLive.isMobile() != 'isMobile') {\n                var report = new ReportLog(opts, 0, 1, null, false);\n            }\n        };\n\n        if (!DW.isH5play) {\n            this.flashPlayerInit();\n        }\n\n        this.getFlash = function () {\n            return swfobject.getObjectById(this.id);\n        };\n\n        this.playbackRate = function (t) {\n            if (!DW.isH5play && MobileLive.isMobile() !== 'isMobile') {\n                return;\n            }\n            var t = parseFloat(t);\n            this.getH5player().playbackRate = t;\n        };\n\n        this.seek = function (t) {\n            if (t < 0) {\n                return;\n            }\n            if (DW.isH5play || MobileLive.isMobile() == 'isMobile') {\n                this.getH5player().currentTime = t;\n            } else {\n                var swf = this.getFlash();\n                if (!swf) {\n                    return;\n                }\n                swf.seek(t);\n            }\n        };\n\n        this.getFlash = function () {\n            return swfobject.getObjectById(this.id);\n        };\n\n        this.getH5player = function () {\n            return $('#playbackVideo')[0];\n        };\n\n        this.getPlayerTime = function () {\n            if (!this.isReady) {\n                return 0;\n            }\n            var t;\n            if (DW.isH5play || MobileLive.isMobile() == 'isMobile') {\n                t = this.getH5player().currentTime;\n            } else {\n                t = parseInt(this.getFlash().getPosition(), 10);\n            }\n            if (isNaN(t) || t < 0) {\n                return 0;\n            }\n\n            return t;\n        };\n\n        this.getDuration = function () {\n            if (DW.isH5play || MobileLive.isMobile() == 'isMobile') {\n                return this.getH5player().duration;\n            } else {\n                var swf = this.getFlash();\n                if (!swf) {\n                    return;\n                }\n                return swf.getDuration();\n            }\n        };\n\n        this.getBuffer = function () {\n\n            if (DW.isH5play || MobileLive.isMobile() == 'isMobile') {\n                return this.getH5player().buffered.end(0);\n            } else {\n                var swf = this.getFlash();\n                if (!swf) {\n                    return;\n                }\n                return swf.getBufferLength();\n            }\n\n        };\n\n        this.setVolume = function (n) {\n            if (DW.isH5play || MobileLive.isMobile() == 'isMobile') {\n                this.getH5player().volume = parseFloat(n);\n            } else {\n                var swf = this.getFlash();\n                if (!swf) {\n                    return;\n                }\n                return swf.setVolume(n);\n            }\n        };\n\n        this.getVolume = function () {\n            if (DW.isH5play || MobileLive.isMobile() == 'isMobile') {\n                return this.getH5player().volume;\n            } else {\n                var swf = this.getFlash();\n                if (!swf) {\n                    return;\n                }\n                return swf.getVolume();\n            }\n        };\n\n        this.play = function () {\n            if (DW.isH5play || MobileLive.isMobile() == 'isMobile') {\n                if (MobileLive.pauseState) {\n                    this.getH5player().play();\n                } else {\n                    this.getH5player().pause();\n                }\n            } else {\n                var swf = this.getFlash();\n                if (!swf) {\n                    return;\n                }\n                return swf.isPlay();\n            }\n        };\n\n        this.setZScale = function (s) {\n            var swf = this.getFlash();\n            if (!swf) {\n                return;\n            }\n            return swf.setZScale(s);\n        };\n\n        this.getZScale = function () {\n            var swf = this.getFlash();\n            if (!swf) {\n                return;\n            }\n            return swf.getZScale();\n        };\n\n        this.setScale = function (s) {\n            var swf = this.getFlash();\n            if (!swf) {\n                return;\n            }\n            return swf.setScale(s);\n        };\n\n        this.getScale = function () {\n            var swf = this.getFlash();\n            if (!swf) {\n                return;\n            }\n            return swf.getScale();\n        };\n\n        this.openSettingPanel = function () {\n            var swf = this.getFlash();\n            if (!swf) {\n                return;\n            }\n            return swf.openSettingPanel();\n        };\n    };\n\n\n    var Socket = function (opts) {\n\n        var isHttps = window.location.protocol === 'https:';\n        var host = opts.chat.host;\n        if (isHttps && host && host.indexOf(':')) {\n            var s = host.split(':');\n            if (s.length == 2) {\n                var port = parseInt(s[1]);\n                if (!isNaN(port)) {\n                    var httpsPort = port + 400;\n                    host = s[0] + ':' + httpsPort;\n                }\n            }\n        }\n\n        var terminal = 0;\n        if (MobileLive.isMobile() == 'isMobile') {\n            terminal = 1;\n        }\n\n        var socket = io.connect(document.location.protocol + '//' + host + '/replay', {\n            query: {\n                roomid: opts.roomId,\n                sessionid: opts.viewer.sessionId,\n                platform: 1,\n                terminal: terminal\n            }\n        });\n    };\n\n    var DrawPanel = function (opts, callbackPlayer) {\n        this.isReady = false;\n\n        var swfUrl = '//zeus.csslcloud.net/flash/Player.swf';\n\n        var flashvars = {\n            'type': 'drawpanel'\n        };\n        var params = {\n            allowFullscreen: 'true',\n            allowScriptAccess: 'always',\n            wmode: 'transparent'\n        };\n        var attributes = {};\n\n        if (!DWDpc.fastMode) {\n            swfobject.embedSWF(swfUrl, opts.drawPanel.id, opts.drawPanel.width, opts.drawPanel.height,\n                '10.0.0', '/flash/expressInstall.swf', flashvars, params, attributes);\n        }\n\n        this.getFlash = function () {\n            if (!this.isReady) {\n                return;\n            }\n\n            return swfobject.getObjectById(opts.drawPanel.id);\n        };\n\n        this.clear = function () {\n            DWDpc.clear();\n            var swf = this.getFlash();\n            if (!swf) {\n                return;\n            }\n            swf.clear();\n        };\n\n        // 画图\n        this.draw = function (j) {\n            DWDpc.draw(j);\n\n            var swf = this.getFlash();\n            if (!swf) {\n                return;\n            }\n\n            swf.draw(j);\n        };\n\n        this.draws = function (js) {\n            var swf = this.getFlash();\n            if (!swf) {\n                return;\n            }\n\n            (function (jstr) {\n                setTimeout(function () {\n                    swf.drawList(jstr);\n                });\n            })(js);\n        };\n\n\n        // 翻页\n        this.filp = function (j) {\n            DWDpc.pageChange(j);\n\n            var swf = this.getFlash();\n            if (!swf) {\n                return;\n            }\n\n            var jj = JSON.parse(j);\n            var u = jj.url;\n            var isHttps = window.location.protocol === 'https:';\n            if (isHttps) {\n                jj.url = u.replace(/http:/g, 'https:');\n            }\n\n            if (options.adapt) {\n                swf.filp(JSON.stringify(jj), 'auto');\n            } else {\n                swf.filp(JSON.stringify(jj));\n            }\n        };\n\n        // 动画\n        this.animation = function (j) {\n            DWDpc.animationChange(j);\n\n            var swf = this.getFlash();\n            if (!swf) {\n                return;\n            }\n\n            swf.animation(j);\n        };\n\n        this.intervalNum = 0;\n\n        // 循环更新翻页和画板信息\n        this.interval = function () {\n\n            var ft = 0;\n            try {\n                ft = callback.callbackPlayer.getPlayerTime();\n            } catch (e) {\n            }\n            if (ft < 0) {\n                return;\n            }\n\n            if (isCustomSeek) {\n                nextTime = ft;\n                if (Math.abs(nextTime - beforeTime) >= 2.5) {\n                    seekComplete && seekComplete();\n                }\n                beforeTime = ft;\n            }\n\n            if (callback.isRequestDraws) {\n                callback.drawsInfoRequestPool.isHttpRequestCurrentDraws(ft, function (data) {\n                    callback.draws = data;\n                });\n            }\n\n            try {\n                if (callback.animations && callback.animations.length > 0) {\n                    if (callback.animationIndex < callback.animations.length) {\n                        var pidex = callback.pageChangeIndex;\n                        if (pidex >= 0) {\n                            var pc = callback.pageChanges[pidex];\n                            var a = callback.animations[callback.animationIndex + 1];\n                            if (!!pc && !!a && pc.encryptDocId == a.encryptDocId && ft >= a.time && pc.time <= a.time) {\n                                if (DWDpc.fastMode) {\n                                    this.animation(a);\n                                } else {\n                                    this.animation(JSON.stringify({\n                                        'fileName': a.docName,\n                                        'totalPage': a.docTotalPage,\n                                        'docid': a.encryptDocId,\n                                        'url': a.url,\n                                        'page': a.pageNum,\n                                        'step': a.step\n                                    }));\n                                }\n                                callback.animationIndex = callback.animationIndex + 1;\n                            }\n                        }\n                    }\n                }\n            } catch (e) {\n            }\n\n            try {\n                if (callback.pageChanges && callback.pageChanges.length > 0) {\n                    if (callback.pageChangeIndex < callback.pageChanges.length) {\n                        var pc = callback.pageChanges[callback.pageChangeIndex + 1];\n                        if (ft >= pc.time) {\n                            if (typeof window.on_cc_callback_page_change === 'function') {\n                                window.on_cc_callback_page_change(pc);\n                            }\n                            if (typeof window.on_cc_request_snapshoot === 'function') {\n                                window.on_cc_request_snapshoot(pc);\n                            }\n                            if (DWDpc.fastMode) {\n                                this.filp(pc);\n                            } else {\n                                this.filp(JSON.stringify({\n                                    'fileName': pc.docName,\n                                    'totalPage': pc.docTotalPage,\n                                    'docid': pc.encryptDocId,\n                                    'url': pc.url,\n                                    'page': pc.pageNum,\n                                    'useSDK': pc.useSDK\n                                }));\n                            }\n\n                            callback.pageChangeIndex = callback.pageChangeIndex + 1;\n\n                            //翻页信息回掉\n                            var obj = {};\n                            obj.docId = pc.docId;\n                            obj.docName = pc.docName;\n                            obj.docTotalPage = pc.docTotalPage;\n                            obj.pageNum = pc.pageNum;\n\n                            if (typeof window.on_cc_callback_pagechange === 'function') {\n                                window.on_cc_callback_pagechange(obj);\n                            }\n\n                        }\n                    }\n                }\n            } catch (e) {\n            }\n\n            try {\n                if (callback.animations && callback.animations.length > 0) {\n                    if (callback.animationIndex < callback.animations.length) {\n                        var pidex = callback.pageChangeIndex;\n                        if (pidex >= 0) {\n                            var pc = callback.pageChanges[pidex];\n                            var a = callback.animations[callback.animationIndex + 1];\n                            if (!!pc && !!a && pc.encryptDocId == a.encryptDocId && ft >= a.time && pc.time <= a.time) {\n                                if (DWDpc.fastMode) {\n                                    this.animation(a);\n                                } else {\n                                    this.animation(JSON.stringify({\n                                        'fileName': a.docName,\n                                        'totalPage': a.docTotalPage,\n                                        'docid': a.encryptDocId,\n                                        'url': a.url,\n                                        'page': a.pageNum,\n                                        'step': a.step\n                                    }));\n                                }\n                                callback.animationIndex = callback.animationIndex + 1;\n                            }\n                        }\n                    }\n                }\n            } catch (e) {\n            }\n\n\n            try {\n                if (callback.draws && callback.draws.length > 0) {\n                    // 画图逻辑\n                    if (callback.drawIndex < callback.draws.length) {\n                        var dc = callback.draws[callback.drawIndex + 1];\n                        while (ft >= dc.time) {\n                            if (DWDpc.fastMode) {\n                                this.draw(dc);\n                            } else {\n                                this.draw(dc.data);\n                            }\n\n                            callback.drawIndex = callback.drawIndex + 1;\n                            dc = callback.draws[callback.drawIndex + 1];\n                        }\n                    }\n                }\n            } catch (e) {\n            }\n        };\n\n        this.intervalPainting = function (callback) {\n            callback.drawPanel.intervalNum = setInterval(function () {\n                callback.drawPanel.interval(callback);\n            }, 1000);\n        };\n    };\n\n    //优化meta数据\n    var substepRequest = function (opts) {\n        $.ajax({\n            url: opts.url,\n            type: 'GET',\n            data: opts.data,\n            tryCount: 0,\n            retryLimit: 3,\n            timeout: 5000,\n            dataType: 'jsonp',\n            success: function (data) {\n                opts.done(data);\n            },\n            error: function (xhr, textStatus, errorThrown) {\n                if (textStatus == 'timeout') {\n                    this.tryCount++;\n                    if (this.tryCount < this.retryLimit) {\n                        //try again\n                        $.ajax(this);\n                        return;\n                    } else {\n                        if (typeof opts.fn === 'function') {\n                            opts.fn(textStatus);\n                        }\n                        return;\n                    }\n                    return;\n                }\n                if (xhr.status == 500) {\n                    //handle error\n                } else {\n                    //handle error\n                }\n            }\n        });\n    };\n\n    var substepRequestHistoryData = function (opts, fn) {\n        var param = {\n            roomid: opts.roomId,\n            userid: opts.userId,\n            liveid: opts.liveId,\n            upid: opts.upId,\n            recordid: opts.recordId,\n            viewertoken: opts.viewertoken,\n            viewername: opts.viewername,\n            forcibly: opts.forcibly\n        };\n\n        var sub = {\n            globalData: {},\n            requestLoginData: false,\n            requestInfoData: false,\n            requestDrawData: false,\n            requestChatqaData: false,\n            allRequests: 0,\n        };\n\n        // 登录\n        substepRequest({\n            url: '//view.csslcloud.net/api/room/replay/login',\n            data: param,\n            fn: window.on_cc_login_error,\n            done: function (data) {\n                if (!checkout(data, window.on_cc_login_error)) {\n                    return false;\n                }\n                if (data.success) {\n                    options.drawRequestTime = parseInt(data.datas.drawRequestTime) || 1;\n                    window.TIMEOUT = window.TIMEOUT + (options.drawRequestTime * 1000);\n                    // options.drawRequestTime = (parseInt(data.datas.drawRequestTime) || 1) * 2;\n                    // options.drawRequestTime = 25;\n                    if (!DWDpc.fastMode) {\n                        options.drawRequestTime = '';\n                    }\n                    util.log('options', options);\n\n                    callback.state = new StateMachine();\n                    var snapshoot = new StateMachine();\n                    callback.drawsInfoRequestPool = new DrawsInfoRequestPool(callback.state, snapshoot);\n                }\n                concatMeta(sub.globalData, data);\n                sub.requestLoginData = true;\n                sub.requestInfoData = false;\n                sub.requestDrawData = false;\n                sub.requestChatqaData = false;\n                sub.allRequests++;\n                success(sub);\n\n                //登录成功\n\n                if (!options.drawRequestTime) {\n                    // 请求画笔数据\n                    substepRequest({\n                        url: '//view.csslcloud.net/api/view/replay/draw/info',\n                        data: param,\n                        fn: window.on_cc_request_draw_error,\n                        done: function (data) {\n                            if (!checkout(data)) {\n                                return false;\n                            }\n                            concatMeta(sub.globalData, data);\n                            sub.requestLoginData = false;\n                            sub.requestInfoData = false;\n                            sub.requestDrawData = true;\n                            sub.requestChatqaData = false;\n                            sub.allRequests++;\n                            success(sub);\n                        }\n                    });\n                }\n\n                // 请求聊天和问答数据\n                substepRequest({\n                    url: '//view.csslcloud.net/api/view/replay/v2/chatqa/info',\n                    data: param,\n                    fn: window.on_cc_request_chatqa_error,\n                    done: function (data) {\n                        if (!checkout(data, window.on_cc_request_chatqa_error)) {\n                            return false;\n                        }\n                        concatMeta(sub.globalData, data);\n                        sub.requestLoginData = false;\n                        sub.requestInfoData = false;\n                        sub.requestDrawData = false;\n                        sub.requestChatqaData = true;\n                        sub.allRequests++;\n                        success(sub);\n                    }\n                });\n\n                // 广播，翻页，animation及后续新增数据\n                substepRequest({\n                    url: '//view.csslcloud.net/api/view/replay/v2/info',\n                    data: param,\n                    fn: window.on_cc_request_info_error,\n                    done: function (data) {\n                        if (!checkout(data, window.on_cc_request_info_error)) {\n                            return false;\n                        }\n                        concatMeta(sub.globalData, data);\n                        sub.requestLoginData = false;\n                        sub.requestInfoData = true;\n                        sub.requestDrawData = false;\n                        sub.requestChatqaData = false;\n                        sub.allRequests++;\n                        success(sub);\n                    }\n                });\n\n            }\n        });\n\n\n        var checkout = function (data, fn) {\n            if (!data.success) {\n                if (typeof fn === 'function') {\n                    fn(data);\n                }\n                return false;\n            }\n\n            if (!data.datas) {\n                return false;\n            }\n\n            return true;\n        };\n\n        var concatMeta = function (d1, d2) {\n            extend(d1, d2);\n            if (!d1.datas.meta) {\n                d1.datas.meta = {};\n            }\n            extend(d1.datas.meta, d2.datas.meta);\n        };\n\n        var extend = function (o, n) {\n            for (var p in n) {\n                if (n.hasOwnProperty(p) && (!o.hasOwnProperty(p) ))\n                    o[p] = n[p];\n            }\n        };\n\n        var success = function (sub) {\n            fn(sub);\n        };\n\n    };\n\n    //优化meta数据 画笔数据--------------------\n\n    //状态机\n    var StateMachine = function () {\n\n        this.requestState = false;\n        this.result = 0;\n        this.startTime = 0;\n        this.endTime = 0;\n        this.key = 0;//key 为每一个状态机块的索引， id 或 index。\n        this.index = 0;//自动排列 key\n        this.ajax = {};\n        this.states = [];\n        this.snapshoot = [];\n        this.drawsAlready = 0;\n\n        this.roomId = options.roomId;\n        this.userId = options.userId;\n        this.recordId = options.recordId;\n        this.liveId = options.liveId;\n        this.drawRequestTime = options.drawRequestTime;\n\n        this.setSnapshoot = function (docId, data) {\n            this.snapshoot[docId] = data;\n        };\n\n        this.getSnapshoot = function () {\n            return this.snapshoot;\n        };\n\n        //初始化状态机\n        this.init = function (options) {\n\n            //分时间块，状态机记录\n            for (var i = 0; i < this.drawRequestTime; i++) {\n                var s = {\n                    requestState: false,\n                    result: 0,\n                    startTime: options.startTime,\n                    endTime: options.endTime,\n                    key: i\n                };\n\n                options.startTime = options.startTime + options.blockTime;\n                options.endTime = options.startTime + options.blockTime;\n                this.setState(s);\n            }\n        };\n\n        this.httpRequest = function (options, callback) {\n            var self = this;\n            self.requestState = true;\n\n            this.ajax = $.ajax({\n                url: options.url,\n                type: 'GET',\n                data: options.param,\n                tryCount: 0,\n                retryLimit: 3,\n                timeout: window.TIMEOUT,//20秒超时\n                dataType: 'jsonp',\n                success: function (data) {\n                    self.result = data;\n                    if (!data.success) {\n                        util.log('data.success', data.success);\n                        return;\n                    }\n                    callback(data);\n                    self.requestState = false;\n                },\n                error: function (xhr, textStatus, errorThrown) {\n                    if (textStatus == 'timeout') {\n                        this.tryCount++;\n                        if (this.tryCount < this.retryLimit) {\n                            //try again\n                            $.ajax(this);\n                            util.log('ajax[' + self.key + '] try again tryCount', this.tryCount);\n                            return;\n                        } else {\n                            util.log('数据请求失败且重试多次');\n                            self.requestState = false;\n                            return;\n                        }\n                        return;\n                    }\n                    if (xhr.status == 500) {\n                        //handle error\n                    } else {\n                        //handle error\n                    }\n                }\n            });\n        };\n\n        this.abort = function () {\n            //模拟中断http请求\n            this.ajax.abort();\n            this.requestState = false;\n        };\n\n        this.setState = function (options) {\n            if (typeof options !== 'object') {\n                return;\n            }\n            //key 为每一个状态机块的索引， id 或 index。\n            var key = (options.key || this.index++);\n            if (options.key && !isNaN(options.key)) {\n                this.index = parseInt(options.key) + 1;\n            }\n            var state = new StateMachine();\n            state.requestState = options.requestState || this.requestState;\n            state.result = options.result || this.result;\n            state.startTime = options.startTime || this.startTime;\n            state.endTime = options.endTime || this.endTime;\n            state.ajax = options.ajax || this.ajax;\n            state.snapshoot = options.snapshoot || this.snapshoot;\n            state.key = key;\n            this.states[key] = state;\n        };\n\n        this.getState = function (key) {\n            return this.states[key];\n        };\n\n        this.getStates = function () {\n            return this.states;\n        };\n\n        this.getCurrentStateIndex = function (currentTime) {\n            var index = 0;\n            for (var i = 0; i < this.states.length; i++) {\n                if (currentTime > this.states[i].startTime && currentTime <= this.states[i].endTime) {\n                    index = i;\n                    break;\n                }\n            }\n            return index;\n        };\n\n        this.isDrawsAlready = function () {\n            return parseInt(this.drawRequestTime, 10) === parseInt(this.drawsAlready, 10);\n        };\n    };\n\n    //画笔信息请求池管理\n    var DrawsInfoRequestPool = function (state, snapshoot) {\n        this.state = state;\n        this.requestNumber = 2;\n        this.httpRequestPool = [];\n        this.draws = [];\n        this.preState = {};\n\n        this.isHttpRequestCurrentDraws = function (currentTime, fn) {\n            if (!state.drawRequestTime) {\n                return;\n            }\n            var drawsAlready = state.isDrawsAlready();\n            if (drawsAlready) {\n                util.log('画笔数据加载完毕，不在预加载某一段数据');\n                return;\n            }\n\n            var states = state.getStates();\n            var index = state.getCurrentStateIndex(currentTime);\n            var _state = states[index];\n\n            if (this.preState != _state && this.preState.requestState) {\n                util.log('发现新的预加载请求，中断上一个预加载请求;index=' + this.preState.key);\n                this.preState.abort();\n            }\n            this.preState = _state;\n\n            //请求数据\n            if (!drawsAlready && !_state.result && !_state.requestState) {\n                util.log('预加载数据', index);\n                var options = {\n                    index: index,\n                    states: states\n                };\n                this.httpRequestCurrentDraws(options, fn);\n            } else {\n                util.log('预加载过这段数据或已有数据;index=' + index);\n            }\n        };\n\n        this.httpRequestCurrentDraws = function (options, fn) {\n            var self = this;\n            var states = options.states;\n            var index = options.index;\n            var _state = states[index];\n\n            var param = {\n                url: '//view.csslcloud.net/api/view/replay/v2/draw/range',\n                param: {\n                    starttime: _state.startTime,\n                    endtime: _state.endTime,\n                    userid: _state.userId,\n                    recordid: _state.recordId,\n                    liveid: _state.liveId,\n                }\n            };\n            _state.httpRequest(param, function (data) {\n                var draw = data.datas.meta.draw;\n                util.log('*** 预加载成功 callback.draws[' + index + '] ***', draw);\n                self.draws = distinct(self.draws, draw);\n                self.draws.sort(function (p1, p2) {\n                    return parseInt(p1.time) - parseInt(p2.time);\n                });\n                fn(self.draws);\n                callback.state.drawsAlready++;\n            });\n        };\n\n        this.httpRequestStream = function (fn) {\n            var self = this;\n            var drawsAlready = self.state.isDrawsAlready();\n            if (drawsAlready) {\n                util.log('httpRequestStream draws already', self.draws);\n                util.log('callback.state', callback.state);\n                util.log('snapshoot', snapshoot);\n                return;\n            }\n            var states = self.state.getStates();\n\n            //获取符合条件的请求\n            for (var i = 0; i < states.length; i++) {\n                var state = states[i];\n                if (!state.result && !state.requestState) {\n                    if (self.httpRequestPool.length < self.requestNumber) {\n                        self.httpRequestPool.push(state);\n                    } else {\n                        break;\n                    }\n                }\n            }\n\n            //处理请求池，发起请求\n            for (var j = 0; j < self.httpRequestPool.length; j++) {\n                var state = self.httpRequestPool[j];\n                if (!state.result && !state.requestState) {\n                    (function (state) {\n                        var options = {\n                            url: '//view.csslcloud.net/api/view/replay/v2/draw/range',\n                            param: {\n                                starttime: state.startTime,\n                                endtime: state.endTime,\n                                userid: state.userId,\n                                recordid: state.recordId,\n                                liveid: state.liveId,\n                            }\n                        };\n                        state.httpRequest(options, function (data) {\n                            var draw = data.datas.meta.draw;\n                            util.log('请求流 draw[' + state.key + ']', draw);\n                            //合并分段请求返回的画笔数据\n                            if (callback.isRequestDraws) {\n                                self.draws = distinct(self.draws, draw);\n                            } else {\n                                self.draws = self.draws.concat(draw);\n                            }\n\n                            //排序\n                            self.draws.sort(function (p1, p2) {\n                                return parseInt(p1.time) - parseInt(p2.time);\n                            });\n                            //回调画笔数据\n                            fn(self.draws);\n                            //请求池管理，删除已完成的请求\n                            for (var k = 0; k < self.httpRequestPool.length; k++) {\n                                if (self.httpRequestPool[k].key == state.key) {\n                                    self.httpRequestPool.splice(k, 1);\n                                    break;\n                                }\n                            }\n                            //继续监测请求池中符合请求条件的请求，发起请求\n                            callback.state.drawsAlready++;\n                            self.httpRequestStream(fn);\n                        });\n                    })(state);\n                }\n            }\n        };\n\n        this.httpRequestSnapshoot = function (e, currentTime, fn) {\n            var self = this;\n            var drawsAlready = state.isDrawsAlready();\n            if (drawsAlready) {\n                util.log('画笔数据请求完整，不在请求快照数据');\n                return;\n            }\n\n            var states = state.getStates();\n            var currentTime = currentTime;\n            var index = state.getCurrentStateIndex(currentTime);\n            var _state = states[index];\n\n            if (!_state) {\n                return;\n            }\n\n            var _snapshoot = snapshoot.getSnapshoot();\n            var _isSnapshoot = _snapshoot[e.docId + '_' + e.pageNum + '_' + e.url];\n\n            //请求快照\n            if (!_state.result && !_isSnapshoot) {//当前时间段是否有数据 && 当前页是否存在快照\n                util.log('_snapshoot.getSnapshoot()', _snapshoot);\n                //中断没有请求完的快照，快照只能存在一个请求\n                if (snapshoot.requestState) {\n                    snapshoot.abort();\n                }\n\n                var options = {\n                    url: '//view.csslcloud.net/api/view/replay/v2/draw/snapshot',\n                    param: {\n                        docid: e.docId,\n                        currentpage: e.pageNum,\n                        userid: snapshoot.userId,\n                        recordid: snapshoot.recordId,\n                    }\n                };\n                snapshoot.httpRequest(options, function (data) {\n                    //缓存快照数据\n                    snapshoot.setSnapshoot(e.docId + '_' + e.pageNum + '_' + e.url, data);\n\n                    if (!_state.result) {\n                        callback.isRequestDraws = true;\n                        var draw = data.datas.meta.draw;\n                        util.log('*** 快照 callback.draws[' + e.docId + '_' + e.pageNum + '_' + e.url + '] ***', draw);\n                        self.draws = distinct(self.draws, draw);\n                        self.draws.sort(function (p1, p2) {\n                            return parseInt(p1.time) - parseInt(p2.time);\n                        });\n                        fn(self.draws);\n                    } else {\n                        util.log('快照请求成功，当前时间段数据存在，丢弃快照' + index + '');\n                    }\n                });\n            } else {\n                util.log('当前时间段存在数据或存在快照', index + '');\n            }\n        };\n\n        function distinct(a, b) {\n            // 数组去重\n            var arr = a.concat(b);\n            var result = [];\n            var obj = {};\n            for (var i in arr) {\n                if (!obj[JSON.stringify(arr[i])]) {\n                    result.push(arr[i]);\n                    obj[JSON.stringify(arr[i])] = 1;\n                }\n            }\n            return result;\n        }\n\n        function unique(oldDraws, newDraws) {\n            //分段数据与快照合并\n            var _oldDraws = oldDraws;\n            var _newDraws = newDraws;\n            var draws = [];\n            for (var i = 0; i < _newDraws.length; i++) {\n                var newDraw = _newDraws[i];\n                for (var j = 0; j < _oldDraws.length; j++) {\n                    var oldDraw = _oldDraws[j];\n                    if (isObjectValueEqual(oldDraw, newDraw)) {\n                        _oldDraws.splice(j, 1);\n                        break;\n                    }\n                }\n            }\n            draws = _oldDraws.concat(_newDraws);\n            return draws;\n        }\n\n        function isObjectValueEqual(a, b) {\n            // Of course, we can do it use for in\n            // Create arrays of property names\n            var aProps = Object.getOwnPropertyNames(a);\n            var bProps = Object.getOwnPropertyNames(b);\n\n            // If number of properties is different,\n            // objects are not equivalent\n            if (aProps.length != bProps.length) {\n                return false;\n            }\n\n            for (var i = 0; i < aProps.length; i++) {\n                var propName = aProps[i];\n\n                // If values of same property are not equal,\n                // objects are not equivalent\n                if (a[propName] !== b[propName]) {\n                    return false;\n                }\n            }\n\n            // If we made it this far, objects\n            // are considered equivalent\n            return true;\n        }\n\n    };\n\n    //防止获取不到duration\n    window.ListenerDuration = function () {\n        if (!on_cc_limit_request_draws) {\n            return;\n        }\n        var t = setInterval(function () {\n            var duration = parseInt(callback.callbackPlayer.getDuration());\n            if (duration) {\n                util.log('ListenerDuration');\n                on_cc_limit_request_draws && on_cc_limit_request_draws();\n                clearInterval(t);\n            }\n        }, 50);\n        window.ListenerDuration = null;\n    };\n\n    window.on_cc_limit_request_draws = function () {\n        if (!options.drawRequestTime) {\n            return;\n        }\n\n        util.log('分页请求画笔数据', options.drawRequestTime);\n        var duration = (callback.callbackPlayer.getDuration()) + 1;\n        util.log('duration', duration + '');\n        //请求数据左包含，右不包含，duration+1秒，防止最后一秒数据无法请求到。\n        var blockTime = Math.ceil(duration / options.drawRequestTime);\n        var startTime = 0;\n        var endTime = startTime + blockTime;\n\n        var blockDuration = {\n            blockTime: blockTime,\n            startTime: startTime,\n            endTime: endTime\n        };\n        callback.state.init(blockDuration);\n\n        util.log('callback.state', callback.state);\n\n        setTimeout(function () {\n            callback.drawsInfoRequestPool.httpRequestStream(function (data) {\n                callback.draws = data;\n                callback.isHistoryReady = true;\n                callback.drawPanel.isReady = true;\n            });\n        }, 10000);\n\n        setTimeout(function () {\n            initDrawPanelInfo();\n        }, 1500);\n\n        window.on_cc_limit_request_draws = null;\n    };\n\n    window.on_cc_request_snapshoot = function (pageChange) {\n        if (!options.drawRequestTime) {\n            return;\n        }\n        util.log('pageChange', pageChange);\n        var currentTime = callback.callbackPlayer.getPlayerTime();\n        callback.drawsInfoRequestPool.httpRequestSnapshoot(pageChange, currentTime, function (data) {\n            callback.draws = data;\n            callback.isHistoryReady = true;\n            callback.drawPanel.isReady = true;\n        });\n    };\n\n    // 历史数据\n    var History = function (opts, callback) {\n\n        substepRequestHistoryData(opts, success);\n\n        //canplay\n        var onCCH5PlayerLoad = false;\n\n        function success(sub) {\n\n            var data = sub.globalData;\n\n            if (sub.requestLoginData) {\n\n                if (DWDpc.fastMode) {\n                    $('#documentDisplayMode').val(data.datas.room.documentDisplayMode);\n                    DWDpc.appendDrawPanel();\n                    DWDpc.init();\n                }\n\n                opts.chat = {\n                    host: data.datas.pusherNode.primary\n                };\n                opts.viewer.sessionId = data.datas.sessionId;\n                opts.liveId = data.datas.encryptLiveId;\n                opts.upId = data.datas.upId;\n                opts.viewerId = data.datas.viewer.id;\n                callback.socket = new Socket(opts);\n\n                if (typeof window.on_cc_callback_player === 'function') {\n                    window.on_cc_callback_player(data.datas.live.encryptRecordvideoId);\n                }\n\n                if (DW.isH5play) {\n                    MobileLive.init(opts);\n                } else if (MobileLive.isMobile() == 'isMobile') {\n                    MobileLive.init(opts);\n                }\n            }\n\n            var datas = data.datas;\n            var meta = datas.meta;\n            if (!meta) {\n                return;\n            }\n\n            if (sub.requestInfoData) {\n                var pages = meta.pageChange;\n\n                for (var i = 0; i < pages.length; i++) {\n                    var imgUrl = pages[i].url;\n                    var isHttps = window.location.protocol === 'https:';\n                    if (imgUrl.indexOf('//') > 0 && isHttps) {\n                        imgUrl = imgUrl.replace('http:', 'https:');\n                        pages[i].url = imgUrl;\n                    }\n                }\n\n                if (typeof window.on_cc_callback_pages === 'function') {\n                    window.on_cc_callback_pages(pages);\n                }\n\n                var pageChanges = meta.pageChange;\n                if (pageChanges && pageChanges.length) {\n                    pageChanges.sort(function (p1, p2) {\n                        return parseInt(p1.time) - parseInt(p2.time);\n                    });\n                    callback.pageChanges = pageChanges;\n                }\n\n                var animations = meta.animation;\n                if (animations && animations.length) {\n                    animations.sort(function (p1, p2) {\n                        return parseInt(p1.time) - parseInt(p2.time);\n                    });\n                    callback.animations = animations;\n                }\n\n                //广播\n                var broadcasts = meta.broadcast;\n                window.chatLogs = meta.broadcast;\n                if (broadcasts && broadcasts.length) {\n                    broadcasts.sort(function (p1, p2) {\n                        return parseInt(p1.time) - parseInt(p2.time);\n                    });\n                    for (var i = 0; i < broadcasts.length; i++) {\n                        var broadcast = broadcasts[i];\n                        if (typeof window.on_cc_live_broadcast_msg == 'function') {\n                            window.on_cc_live_broadcast_msg({\n                                content: broadcast.content,\n                                time: broadcast.time\n                            });\n                        }\n                    }\n                    callback.broadcasts = broadcasts;\n                }\n            }\n\n            if (sub.requestChatqaData) {\n                var questions = meta.question;\n                if (questions && questions.length) {\n                    questions.sort(function (p1, p2) {\n                        return parseInt(p1.time) - parseInt(p2.time);\n                    });\n                    callback.questions = questions;\n                    for (var i = 0; i < callback.questions.length; i++) {\n                        var question = questions[i];\n\n                        if (typeof window.on_cc_live_qa_question === 'function') {\n                            window.on_cc_live_qa_question({\n                                'action': 'question',\n                                'value': {\n                                    'id': question.encryptId,\n                                    'content': question.content,\n                                    'userId': question.questionUserId,\n                                    'userName': question.questionUserName,\n                                    'userAvatar': question.questionUserAvatar,\n                                    'isPublish': question.isPublish\n                                }\n                            });\n                        }\n                    }\n                }\n\n                var answers = meta.answer;\n                if (answers && answers.length) {\n                    answers.sort(function (p1, p2) {\n                        return parseInt(p1.time) - parseInt(p2.time);\n                    });\n                    callback.answers = answers;\n\n                    for (var i = 0; i < callback.answers.length; i++) {\n                        var answer = answers[i];\n\n                        if (typeof window.on_cc_live_qa_answer === 'function') {\n                            window.on_cc_live_qa_answer({\n                                'action': 'answer',\n                                'value': {\n                                    'questionId': answer.encryptId,\n                                    'content': answer.content,\n                                    'userId': answer.answerUserId,\n                                    'isPrivate': answer.isPrivate,\n                                    'userName': answer.answerUserName,\n                                    'userAvatar': answer.answerUserAvatar,\n                                    'userRole': answer.answerUserRole\n                                }\n                            });\n                        }\n                    }\n                }\n\n                var chatLogs = meta.chatLog;\n                window.chatLogs = meta.chatLog;\n                if (chatLogs && chatLogs.length) {\n                    chatLogs.sort(function (p1, p2) {\n                        return parseInt(p1.time) - parseInt(p2.time);\n                    });\n                    for (var i = 0; i < chatLogs.length; i++) {\n                        var chatLog = chatLogs[i];\n                        if (typeof window.on_cc_live_chat_msg === 'function') {\n                            window.on_cc_live_chat_msg({\n                                userid: chatLog.userId,\n                                username: chatLog.userName,\n                                time: chatLog.time,\n                                msg: chatLog.content,\n                                useravatar: chatLog.userAvatar,\n                                userRole: chatLog.userRole,\n                                usercustommark: chatLog.userCustomMark\n                            });\n                        }\n                    }\n                    callback.chatLogs = chatLogs;\n                }\n\n                if (window.chatLogs && window.chatLogs.length) {\n                    window.CHATLOGS = window.chatLogs;\n                    cc_live_callback_chat_interval();\n                }\n\n                if (window.broadcasts && window.broadcasts.length) {\n                    //广播\n                    window.BROADCASTS = window.broadcasts;\n                    cc_live_callback_broadcasts_interval();\n                }\n            }\n\n            if (sub.requestDrawData) {\n                var draws = meta.draw;\n                if (draws && draws.length) {\n                    callback.draws = draws;\n                }\n\n                callback.isHistoryReady = true;\n\n                callback.drawPanel.isReady = true;\n                setTimeout(function () {\n                    initDrawPanelInfo();\n                }, 1500);\n            }\n\n            window.on_cc_h5_player_load = function () {\n                callback.callbackPlayer.isReady = true;\n                if (onCCH5PlayerLoad) {\n                    return;\n                }\n                onCCH5PlayerLoad = true;\n\n                var playbackPanel = document.getElementById('drawPanel');\n                if (playbackPanel) {\n                    $.Callback.config({playerId: 'playbackVideo'}, meta);\n                }\n\n            };\n\n        }\n\n    };\n\n    //广播\n    var BroadcastCache = function () {\n        this.cache = [];\n        this.lastTimeRefresh = new Date().getTime();\n\n        this.INTERVAL_TIME = setInterval(function () {\n            callback.broadcastCache.refresh();\n        }, 80);\n\n        //\n        this.push = function (data) {\n            // 缓存中超过5000条数据，则丢弃\n            if (this.cache.length > 5000) {\n                return;\n            }\n            this.cache.push(data);\n        };\n\n        this.ableRefresh = function () {\n            var n = new Date().getTime();\n\n            if (this.cache.length == 0) {\n                return false;\n            }\n\n            if ((n - this.lastTimeRefresh) >= 80) {\n                return true;\n            }\n            return false;\n        };\n\n        this.refresh = function () {\n            if (!this.ableRefresh()) {\n                return;\n            }\n\n            clearInterval(this.INTERVAL_TIME);\n\n            var d = [];\n            var l = Math.min(this.cache.length, 10);\n            for (var i = 0; i < l; i++) {\n                d.push(this.cache.shift());\n            }\n\n            if (typeof window.on_cc_live_broadcast_msg_sync === 'function') {\n                window.on_cc_live_broadcast_msg_sync(d);\n            }\n\n            this.lastTimeRefresh = new Date().getTime();\n\n            this.INTERVAL_TIME = setInterval(function () {\n                callback.broadcastCache.refresh();\n            }, 80);\n        };\n    };\n\n    var ChatMessageCache = function () {\n        this.cache = [];\n        this.lastTimeRefresh = new Date().getTime();\n\n        this.INTERVAL_TIME = setInterval(function () {\n            callback.chatMessageCache.refresh();\n        }, 80);\n\n        //\n        this.push = function (data) {\n            // 缓存中超过5000条数据，则丢弃\n            if (this.cache.length > 5000) {\n                return;\n            }\n            this.cache.push(data);\n        };\n\n        this.ableRefresh = function () {\n            var n = new Date().getTime();\n\n            if (this.cache.length == 0) {\n                return false;\n            }\n\n            if ((n - this.lastTimeRefresh) >= 80) {\n                return true;\n            }\n            return false;\n        };\n\n        this.refresh = function () {\n            if (!this.ableRefresh()) {\n                return;\n            }\n\n            clearInterval(this.INTERVAL_TIME);\n\n            var d = [];\n            var l = Math.min(this.cache.length, 10);\n            for (var i = 0; i < l; i++) {\n                d.push(this.cache.shift());\n            }\n\n            if (typeof window.on_cc_live_chat_msg_sync === 'function') {\n                window.on_cc_live_chat_msg_sync(d);\n            }\n\n            this.lastTimeRefresh = new Date().getTime();\n\n            this.INTERVAL_TIME = setInterval(function () {\n                callback.chatMessageCache.refresh();\n            }, 80);\n        };\n    };\n\n    var Callback = function (opts) {\n        this.chatLogs = [];\n        this.broadcasts = [];\n        this.draws = [];\n        this.pageChanges = [];\n        // 获取历史数据成功\n        this.isHistoryReady = false;\n        this.questions = [];\n        this.answers = [];\n        this.pageChanges = [];\n        this.draws = [];\n        this.animations = [];\n        this.pageChangeIndex = -1;\n        this.drawIndex = -1;\n        this.animationIndex = -1;\n        this.isRequestDraws = false;\n\n        //this.callbackPlayer = new CallbackPlayer(opts);\n        //this.socket = new Socket(opts);\n        this.drawPanel = new DrawPanel(opts, this);\n        this.history = new History(opts, this);\n        this.chatMessageCache = new ChatMessageCache();\n        //广播\n        this.broadcastCache = new BroadcastCache();\n    };\n\n    var callback = {};\n\n    var util = {\n        debug: true,\n        log: function (arg1, arg2) {\n            if (this.debug) {\n                if (arg2) {\n                    console.log(arg1 + ' => ', arg2);\n                } else {\n                    console.log(arg1);\n                }\n            }\n        }\n    };\n\n    window.TIMEOUT = 5000;\n\n    var options = {\n        userId: $('#userId').val(),\n        roomId: $('#roomId').val(),\n        liveId: $('#liveId').val(),\n        recordId: $('#recordId').val(),\n        videoId: $('#videoId').val(),\n        adapt: false,\n        isShowBar: 0,\n        viewerId: $('#viewerId').val(),\n        upId: $('#upId').val(),\n        // 观看者用户信息\n        viewer: {\n            id: $('#viewerId').val(),\n            name: $('#viewerName').val(),\n            role: $('#viewerRole').val(),\n            sessionId: $('#sessionId').val()\n        },\n\n        // 直播播放器信息\n        callbackPlayer: {\n            id: 'playbackPlayer',\n            width: '100%',\n            height: '100%'\n        },\n\n        // 画板信息\n        drawPanel: {\n            id: 'playbackPanel',\n            width: '100%',\n            height: '100%'\n        }\n    };\n\n    //极速文档模式\n    var DWDpc = {\n        dpc: {},\n        fastMode: false,\n        init: function () {\n            this.dpc = new Dpc();\n        },\n        appendDrawPanel: function () {\n            var dp = '<iframe id=\"dpa\" allow-scripts allowfullscreen allowusermedia frameborder=\"0\" style=\"width: 100%;height:100%;\"></iframe>';\n            if (MobileLive.isMobile() == 'isMobile') {\n                dp = '<iframe id=\"dpa\" allow-scripts allowfullscreen allowusermedia frameborder=\"0\" style=\"width: 100%;height:100%;pointer-events: none;\"></iframe>';\n            }\n            $('#playbackPanel').parent().append(dp);\n            $('div#playbackPanel').remove();\n\n            if (typeof window.on_cc_live_db_flip === 'function') {\n                window.on_cc_live_db_flip();\n            }\n        },\n        pageChange: function (pc) {\n            if (!this.fastMode) {\n                return;\n            }\n            this.dpc.pageChange(pc);\n        },\n        animationChange: function (ac) {\n            if (!this.fastMode) {\n                return;\n            }\n            this.dpc.animationChange(ac);\n        },\n        history: function (h) {\n            if (!this.fastMode) {\n                return;\n            }\n            this.dpc.history(h);\n        },\n        draw: function (d) {\n            if (!this.fastMode) {\n                return;\n            }\n            this.dpc.draw(d);\n        },\n        clear: function () {\n            if (!this.fastMode) {\n                return;\n            }\n            this.dpc.clear();\n        }\n    };\n\n    function init(opts) {\n        options.viewerId = opts.viewerid;\n        options = $.extend(options, opts);\n\n        callback = new Callback(options);\n    }\n\n    var DW = {\n        isH5play: false,\n        fastMode: false,\n        setFastMode: function (opts) {\n            if (typeof opts.fastMode == 'string') {\n                if (opts.fastMode === 'false') {\n                    this.fastMode = false;\n                } else {\n                    this.fastMode = true;\n                }\n            } else if (typeof opts.fastMode == 'boolean') {\n                this.fastMode = opts.fastMode;\n            } else {\n                this.fastMode = false;\n            }\n        },\n        // 初始化DW对象\n        config: function (opts) {\n            if (checkVideo()) {\n                this.isH5play = opts.isH5play;\n            }\n\n            this.setFastMode(opts);\n            DWDpc.fastMode = this.fastMode;\n\n            var scriptArray = [\n                '//static.csslcloud.net/js/socket.io.js',\n                '//static.csslcloud.net/js/swfobject.js',\n                '//static.csslcloud.net/js/json3.min.js',\n                '//static.csslcloud.net/js/module/drawingBoard-2.0.0.js',\n                '//static.csslcloud.net/js/module/drawingBoardPlayback.js',\n                '//static.csslcloud.net/js/report.js'\n            ];\n            if (DWDpc.fastMode) {\n                scriptArray.splice(3, 2);\n            }\n\n            this.loadScript(scriptArray, function () {\n                init(opts);\n                if (MobileLive.isMobile() == 'isMobile' && $.DrawingBoard && !DWDpc.fastMode) {\n                    DW.appendDrawPanel();\n                }\n            });\n        },\n        appendDrawPanel: function () {\n            var dp = '<canvas id=\"drawPanel\" width=\"1200\" height=\"1200\" style=\"position: absolute;z-index:2;top:0;left: 0\"></canvas>'\n                + '<iframe id=\"dpa\" src=\"\" frameborder=\"0\" style=\"position: absolute;top:0;left: 0\"></iframe>';\n            $('#playbackPanel').parent().append(dp);\n            $('div#playbackPanel').remove();\n        },\n        logout: function () {\n            $.ajax({\n                url: '//view.csslcloud.net/api/callback/logout',\n                type: 'GET',\n                dataType: 'json',\n                timeout: 5000,\n                xhrFields: {\n                    withCredentials: true\n                },\n                success: function (data) {\n                },\n                error: function (xhr, status, error) {\n                }\n            });\n        },\n\n        getScript: function (url, success) {\n\n            var readyState = false,\n                script = document.createElement('script');\n            script.src = url;\n\n            script.onload = script.onreadystatechange = function () {\n                if (!readyState && (!this.readyState || this.readyState == 'loaded' || this.readyState == 'complete')) {\n                    readyState = true;\n                    success && success();\n                }\n            };\n            document.body.appendChild(script);\n\n        },\n\n        loadScript: function (res, callback) {\n\n            if (typeof res === 'string') {\n                var _res = res;\n                res = [];\n                res.push(_res);\n            }\n            var _this = this,\n                queue = function (fs, cb) {\n                    _this.getScript(fs.shift(), function () {\n                        fs.length ? queue(fs, cb) : cb && cb();\n                    });\n                };\n\n            queue(res, callback);\n\n        },\n\n        playbackRate: function (t) {\n            callback.callbackPlayer.playbackRate(t);\n        },\n\n        seek: function (t) {\n            clearInterval(callback.drawPanel.intervalNum);\n            callback.callbackPlayer.seek(t);\n        },\n\n        getPlayerTime: function () {\n\n            return callback.callbackPlayer.getPlayerTime();\n\n        },\n\n        getDuration: function () {\n            if (DW.isH5play) {\n                return MobileLive.getDuration();\n            } else if (MobileLive.isMobile() == 'isMobile') {\n                return MobileLive.getDuration();\n            } else {\n                return callback.callbackPlayer.getDuration();\n            }\n        },\n\n        docAdapt: function (t) {\n            options.adapt = t;\n        },\n\n        isShowBar: function (n) {\n            options.isShowBar = n;\n        },\n\n        getBuffer: function () {\n            return callback.callbackPlayer.getBuffer();\n        },\n\n        setVolume: function (n) {\n            return callback.callbackPlayer.setVolume(n);\n        },\n\n        getVolume: function () {\n            return callback.callbackPlayer.getVolume();\n        },\n\n        play: function () {\n            return callback.callbackPlayer.play();\n        },\n\n        setZScale: function (s) {\n            return callback.callbackPlayer.setZScale(s);\n        },\n\n        getZScale: function () {\n            return callback.callbackPlayer.getZScale();\n        },\n\n        setScale: function (s) {\n            return callback.callbackPlayer.setScale(s);\n        },\n\n        getScale: function () {\n            return callback.callbackPlayer.getScale();\n        },\n\n        openSettingPanel: function () {\n            return callback.callbackPlayer.openSettingPanel();\n        }\n\n    };\n\n    $.extend({\n        DW: DW\n    });\n\n\n    function isLivePlayerReady() {\n        if (!callback.callbackPlayer.isReady) {\n            setTimeout(function () {\n                isLivePlayerReady();\n            }, 500);\n            return;\n        }\n\n        callback.drawPanel.intervalPainting(callback);\n    }\n\n    // 初始化画板数据\n    function initDrawPanelInfo() {\n        // 等待历史数据加载成功\n        if (!callback.isHistoryReady) {\n            setTimeout(function () {\n                initDrawPanelInfo();\n            }, 300);\n            return;\n        }\n\n        isLivePlayerReady();\n    }\n\n    window.on_cc_callback_player = function (videoId) {\n        options.videoId = videoId;\n        callback.callbackPlayer = new CallbackPlayer(options);\n    };\n\n    // 播放器加载完成，开始播放\n    window.on_cc_live_player_init = function () {\n        callback.callbackPlayer.isReady = true;\n        try {\n            callback.callbackPlayer.getFlash().start();\n        } catch (e) {\n        }\n        // 同时开始实时显示聊天信息\n        setInterval(function () {\n            var ft = 0;\n            try {\n                ft = callback.callbackPlayer.getPlayerTime();\n            } catch (e) {\n            }\n            if (ft <= 0) {\n                return;\n            }\n\n            if (!callback.chatLogs.length) {\n                return;\n            }\n\n            var chatLog = callback.chatLogs[0];\n            while (chatLog.time <= ft) {\n                chatLog = callback.chatLogs.shift();\n\n                callback.chatMessageCache.push({\n                    userid: chatLog.userId,\n                    username: chatLog.userName,\n                    time: chatLog.time,\n                    msg: chatLog.content,\n                    useravatar: chatLog.userAvatar,\n                    userRole: chatLog.userRole,\n                    usercustommark: chatLog.userCustomMark\n                });\n\n                if (!callback.chatLogs.length) {\n                    break;\n                }\n\n                chatLog = callback.chatLogs[0];\n            }\n        }, 1000);\n\n        // 同时开始实时显示广播\n        setInterval(function () {\n            var ft = 0;\n            try {\n                ft = callback.callbackPlayer.getPlayerTime();\n            } catch (e) {\n            }\n            if (ft <= 0) {\n                return;\n            }\n\n            if (!callback.broadcasts.length) {\n                return;\n            }\n\n            var broadcast = callback.broadcasts[0];\n            while (broadcast.time <= ft) {\n                broadcast = callback.broadcasts.shift();\n\n                callback.broadcastCache.push({\n                    content: broadcast.content,\n                    time: broadcast.time\n                });\n\n                if (!callback.broadcasts.length) {\n                    break;\n                }\n\n                broadcast = callback.broadcasts[0];\n            }\n        }, 1000);\n\n        if (typeof window.on_cc_live_player_load === 'function') {\n            window.on_cc_live_player_load();\n        }\n\n        if (on_cc_limit_request_draws) {\n            var duration = parseInt(callback.callbackPlayer.getDuration());\n            if (duration) {\n                on_cc_limit_request_draws && on_cc_limit_request_draws();\n            } else {\n                ListenerDuration && ListenerDuration();\n            }\n        }\n\n    };\n\n    function cc_live_callback_chat_interval() {\n        setInterval(function () {\n            var ft = 0;\n            try {\n                ft = parseInt($('#playbackVideo')[0].currentTime, 10);\n            } catch (e) {\n            }\n            if (ft <= 0) {\n                return;\n            }\n\n            if (!window.CHATLOGS.length) {\n                return;\n            }\n\n            var chatLog = window.CHATLOGS[0];\n\n            while (chatLog.time <= ft) {\n                var cl = window.CHATLOGS.shift();\n                callback.chatMessageCache.push({\n                    userid: cl.userId,\n                    username: cl.userName,\n                    time: cl.time,\n                    msg: cl.content,\n                    useravatar: cl.userAvatar,\n                    userRole: cl.userRole,\n                    usercustommark: cl.userCustomMark\n                });\n                if (!window.CHATLOGS.length) {\n                    break;\n                }\n                chatLog = window.CHATLOGS[0];\n            }\n\n        }, 1000);\n    }\n\n    function cc_live_callback_broadcasts_interval() {\n        setInterval(function () {\n            var ft = 0;\n            try {\n                ft = parseInt($('#playbackVideo')[0].currentTime, 10);\n            } catch (e) {\n            }\n            if (ft <= 0) {\n                return;\n            }\n\n            //广播\n            if (!window.BROADCASTS.length) {\n                return;\n            }\n\n            var broadcast = window.BROADCASTS[0];\n\n            while (broadcast.time <= ft) {\n                var bc = window.BROADCASTS.shift();\n                callback.broadcastCache.push({\n                    content: bc.content,\n                    time: bc.time\n                });\n\n                if (!window.BROADCASTS.length) {\n                    break;\n                }\n                broadcast = window.BROADCASTS[0];\n            }\n\n        }, 1000);\n    }\n\n    // 画板Flash加载完成回调\n    //window.on_drampanel_ready = function () {\n    //    callback.drawPanel.isReady = true;\n    //\n    //    setTimeout(function () {\n    //        initDrawPanelInfo();\n    //    }, 1500);\n    //};\n\n    window.seekStart = function () {\n        clearInterval(callback.drawPanel.intervalNum);\n    };\n\n    // 拖动时间轴或跳动播放成功后回调函数\n    window.seekComplete = function () {\n        callback.drawPanel.clear();\n        //clearInterval(callback.drawPanel.intervalNum);\n\n        var ft = callback.callbackPlayer.getPlayerTime();\n        if (ft < 0) {\n            ft = 0;\n        }\n\n        callback.pageChangeIndex = -1;\n        callback.drawIndex = -1;\n        callback.animationIndex = -1;\n\n        var meta = {\n            pageChange: [],\n            animation: [],\n            draw: []\n        };\n\n        if (callback.pageChanges && callback.pageChanges.length > 0) {\n            for (var i = 0; i < callback.pageChanges.length; i++) {\n                var pc = callback.pageChanges[i];\n                if (ft >= pc.time) {\n                    callback.pageChangeIndex = i;\n                }\n            }\n\n            if (callback.pageChangeIndex >= 0) {\n                var pc = callback.pageChanges[callback.pageChangeIndex];\n                if (typeof window.on_cc_callback_page_change === 'function') {\n                    window.on_cc_callback_page_change(pc);\n                }\n                if (typeof window.on_cc_request_snapshoot === 'function') {\n                    window.on_cc_request_snapshoot(pc);\n                }\n                callback.drawPanel.filp(JSON.stringify({\n                    'fileName': pc.docName,\n                    'totalPage': pc.docTotalPage,\n                    'docid': pc.encryptDocId,\n                    'url': pc.url,\n                    'page': pc.pageNum,\n                    'useSDK': pc.useSDK\n                }));\n\n                meta.pageChange.push(pc);\n            }\n        }\n\n        if (callback.animations && callback.animations.length > 0) {\n            for (var i = 0; i < callback.animations.length; i++) {\n                var a = callback.animations[i];\n                if (ft >= a.time) {\n                    callback.animationIndex = i;\n                }\n            }\n\n            if (callback.animationIndex >= 0) {\n                var pidex = callback.pageChangeIndex;\n                if (pidex >= 0) {\n                    var pc = callback.pageChanges[pidex];\n                    var a = callback.animations[callback.animationIndex];\n\n                    if (!!pc && !!a && pc.encryptDocId == a.encryptDocId && ft >= a.time && pc.time <= a.time) {\n                        callback.drawPanel.animation(JSON.stringify({\n                            'fileName': a.docName,\n                            'totalPage': a.docTotalPage,\n                            'docid': a.encryptDocId,\n                            'url': a.url,\n                            'page': a.pageNum,\n                            'step': a.step\n                        }));\n\n                        meta.animation.push(a);\n\n                    }\n                }\n            }\n        }\n\n        if (callback.draws && callback.draws.length > 0) {\n            for (var i = 0; i < callback.draws.length; i++) {\n                var dc = callback.draws[i];\n                if (ft >= dc.time) {\n                    //callback.drawPanel.draw(dc.data);\n                    callback.drawIndex = i;\n                }\n            }\n\n            var ds = callback.draws.slice(0, (callback.drawIndex + 1));\n            if (ds.length > 0) {\n                var dcdatas = [];\n                for (var i = 0; i < ds.length; i++) {\n                    var dc = ds[i];\n                    dcdatas.push(dc.data);\n                    meta.draw.push(dc);\n                }\n                callback.drawPanel.draws(dcdatas);\n            }\n        }\n\n        DWDpc.history(meta);\n\n        callback.drawPanel.intervalNum = setInterval(function () {\n            callback.drawPanel.interval();\n        }, 1000);\n    };\n\n    //事件兼容处理\n    var Event = {};\n    Event.addEvents = function (target, eventType, handle) {\n        if (document.addEventListener) {\n            Event.addEvents = function (target, eventType, handle) {\n                target.addEventListener(eventType, handle, false);\n            };\n        } else {\n            Event.addEvents = function (target, eventType, handle) {\n                target.attachEvent('on' + eventType, function () {\n                    handle.call(target, arguments);\n                });\n            };\n        }\n        ;\n        Event.addEvents(target, eventType, handle);\n    };\n\n    //video兼容处理\n    function checkVideo() {\n        if (!!document.createElement('video').canPlayType) {\n            var vidTest = document.createElement('video');\n            oggTest = vidTest.canPlayType('video/ogg; codecs=\"theora, vorbis\"');\n            if (!oggTest) {\n                h264Test = vidTest.canPlayType('video/mp4; codecs=\"avc1.42E01E, mp4a.40.2\"');\n                if (!h264Test) {\n                    return false;\n                }\n                else {\n                    if (h264Test == 'probably') {\n                        return true;\n                    }\n                    else {\n                        return false;\n                    }\n                }\n            }\n            else {\n                if (oggTest == 'probably') {\n                    return true;\n                }\n                else {\n                    return false;\n                }\n            }\n        }\n        else {\n            return false;\n        }\n    }\n\n    var beforeTime = 0;\n    var nextTime = 0;\n    // var skipOnceSeek = false;\n    var isCustomSeek = true;\n\n    var MobileLive = {\n        pauseState: false,\n        init: function (opts) {\n            var _this = this;\n            $.ajax({\n                url: '//view.csslcloud.net/api/vod/play/mobile',\n                type: 'GET',\n                dataType: 'jsonp',\n                data: {userid: opts.userId, videoid: opts.videoId},\n                success: function (data) {\n                    var pvdefault = data.video[0];\n\n                    var playurl = pvdefault.playurl;\n                    var secureplayurl = pvdefault.secureplayurl;\n\n                    var isHttps = window.location.protocol === 'https:';\n                    if (isHttps && !!secureplayurl) {\n                        playurl = secureplayurl;\n                    }\n\n                    _this.appendVideo(playurl, opts);\n                }\n            });\n        },\n\n        appendVideo: function (s, opts) {\n            var _this = this;\n\n            var v = '<video id=\"playbackVideo\" webkit-playsinline playsinline controls autoplay x-webkit-airplay=\"deny\" x5-playsinline width=\"100%\" height=\"100%\" src=\"' + s + '\"></video>';\n            $('#' + playbackPlayer.id).html(v);\n            var video = document.getElementById('playbackVideo');\n            if (opts.isShowBar) {\n                video.removeAttribute('controls');\n            }\n\n            var isMobie = 0;\n            var ua = 1;\n            if (MobileLive.isMobile() == 'isMobile') {\n                isMobie = 1;\n                ua = 11;\n            }\n            var report = new ReportLog(opts, isMobie, ua, video, false);\n            if (!this.isAndroid()) {\n                this.pauseState = true;\n            }\n\n            Event.addEvents(video, 'canplay', function () {\n                if (MobileLive.isMobile() == 'isMobile') {\n                    window.on_cc_live_player_load && window.on_cc_live_player_load();\n                    window.on_cc_h5_player_load && window.on_cc_h5_player_load();\n                } else if (DW.isH5play) {\n                    window.on_cc_live_player_init && window.on_cc_live_player_init();\n                }\n\n                if (on_cc_limit_request_draws) {\n                    var duration = parseInt(callback.callbackPlayer.getDuration());\n                    if (duration) {\n                        on_cc_limit_request_draws && on_cc_limit_request_draws();\n                    } else {\n                        ListenerDuration && ListenerDuration();\n                    }\n                }\n\n            }, false);\n\n            Event.addEvents(video, 'playing', function () {\n                _this.pauseState = false;\n                window.on_player_start && on_player_start();\n                window.on_spark_player_resume && on_spark_player_resume();\n            }, false);\n\n            Event.addEvents(video, 'pause', function () {\n                _this.pauseState = true;\n                window.on_spark_player_pause && on_spark_player_pause();\n            }, false);\n\n            Event.addEvents(video, 'ended', function () {\n                window.on_spark_player_end && on_spark_player_end();\n            }, false);\n\n            Event.addEvents(video, 'seeking', function () {\n                isCustomSeek = false;\n                seekStart && seekStart();\n            }, false);\n\n            Event.addEvents(video, 'seeked', function () {\n                isCustomSeek = false;\n                seekComplete && seekComplete();\n            }, false);\n        },\n\n        getDuration: function () {\n            var v = document.getElementById('playbackVideo');\n            if (!v) {\n                return;\n            }\n            return Math.floor(v.duration);\n        },\n\n        getPlayerTime: function () {\n            var v = document.getElementById('playbackVideo');\n            if (!v) {\n                return;\n            }\n            return Math.floor(v.currentTime);\n        },\n\n        end: function () {\n            $('#' + playbackPlayer.id).html('end');\n        },\n\n        appendDoc: function (s) {\n            var img = '<img src=\"' + s + '\" />';\n            $('#' + playbackPanel.id).append(img);\n        },\n\n        isMobile: function () {\n            if (this.isIPad() || this.isIPhone() || this.isAndroid() || this.isWindowsPhone()) {\n                return 'isMobile';\n            }\n        },\n\n        isIPad: function () {\n            return navigator.userAgent.match(/iPad/i) != null;\n        },\n\n        isIPhone: function () {\n            return navigator.userAgent.match(/iPhone/i) != null;\n        },\n\n        isAndroid: function () {\n            return navigator.userAgent.match(/Android/i) != null;\n        },\n\n        isWindowsPhone: function () {\n            return navigator.userAgent.match(/Windows Phone/i) != null;\n        }\n\n    };\n\n\n})(jQuery, window, document, undefined);\n\n\n// WEBPACK FOOTER //\n// ./js/playbackSDK.js"],"sourceRoot":""}